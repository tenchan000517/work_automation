# ヒアリングシート運用マニュアル

## 概要

先方（クライアント企業）にGoogleフォームでヒアリングシートを入力してもらい、GASで内部用シートに自動転記する仕組み。

---

## 全体フロー

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│    営業が受注    │ →   │  フォームURL送付  │ →   │  先方がフォーム入力 │
└─────────────────┘     └─────────────────┘     └─────────────────┘
                                                        │
                                                        ▼
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│ AI用データ出力   │ ←   │  内容確認・補足   │ ←   │  GASで内部シートに │
│ （既存スクリプト） │     │  入力            │     │  転記            │
└─────────────────┘     └─────────────────┘     └─────────────────┘
```

---

## セットアップ手順

### 1. Googleフォームの作成

1. Googleドライブで「新規」→「Googleフォーム」
2. `docs/ヒアリングシート_フォーム設計.md` の内容に従って質問を作成
3. フォームの設定：
   - 「回答」タブ → スプレッドシートアイコン → 「新しいスプレッドシートを作成」
   - 回答を収集するスプレッドシートが自動作成される

### 2. GASスクリプトの設定

1. フォーム回答スプレッドシートを開く
2. 「拡張機能」→「Apps Script」
3. `docs/gas/formToInternalSheet.js` の内容をコピー&ペースト
4. `INTERNAL_SHEET_ID` を設定（任意）
   - 同じスプレッドシート内にシートを作成する場合は変更不要
   - 別のスプレッドシートに転記する場合はそのIDを設定
5. 保存（Ctrl+S）
6. `onOpen` を実行して権限を承認

### 3. 列マッピングの調整

1. スプレッドシートを再読み込み
2. メニュー「ヒアリングシート転記」→「列マッピング確認」
3. フォームの質問順と `FORM_COLUMNS` の設定が一致しているか確認
4. ズレがある場合は `FORM_COLUMNS` の数値を調整

---

## 日常運用

### 先方へのフォーム送付

```
【送付メール例】

件名: 【ご記入のお願い】採用求人ヒアリングシート

○○株式会社
○○様

お世話になっております。
株式会社Singの○○です。

この度は採用求人掲載のご依頼をいただき、誠にありがとうございます。
つきましては、求人原稿作成に必要な情報のご記入をお願いいたします。

▼ヒアリングシート入力フォーム
[フォームのURL]

【所要時間】約15〜20分
【入力期限】○月○日（○）まで

ご不明な点がございましたら、お気軽にお問い合わせください。
何卒よろしくお願いいたします。
```

### フォーム回答の転記

1. フォーム回答スプレッドシートを開く
2. 新しい回答が入っていることを確認
3. 転記方法を選択：
   - **選択行を転記**: 転記したい行をクリックして選択 → メニュー「選択行を内部シートに転記」
   - **最新を転記**: メニュー「最新の回答を転記」

4. 転記完了のダイアログが表示される
5. 転記済みの行には「転記済み」列にチェックが入る

### 内部シートの確認・補足

1. 転記先のスプレッドシートを開く
2. 「企業名_日付」のシートが作成されている
3. 内容を確認し、必要に応じて補足・修正
4. AI用データ出力（既存のGASスクリプト）を実行

---

## トラブルシューティング

### Q: 列がズレて転記される

**A:** フォームの質問を追加/削除/並び替えした場合、列マッピングがズレます。
1. 「列マッピング確認」で現在の状態を確認
2. `FORM_COLUMNS` の数値を修正

### Q: 転記先シートが作成されない

**A:** 権限の問題の可能性があります。
1. Apps Scriptエディタで `onOpen` を手動実行
2. 権限の承認ダイアログが表示されたら承認

### Q: 同じ企業名で複数回転記するとエラー

**A:** 同名シートの作成を避けるため、タイムスタンプが自動追加されます。
- シート名: `企業名_日付_タイムスタンプ`

---

## ファイル一覧

| ファイル | 場所 | 用途 |
|---------|------|------|
| ヒアリングシート_フォーム設計.md | docs/ | フォームの項目設計書 |
| formToInternalSheet.js | docs/gas/ | 転記用GASスクリプト |
| new-format-export.js | docs/gas/ | AI用データ出力（新形式） |
| old-format-export.js | docs/gas/ | AI用データ出力（旧形式） |

---

## 今後の拡張案

1. **自動通知**: フォーム回答時にSlack/メール通知
2. **自動転記**: フォーム送信と同時に自動で内部シート作成
3. **入力チェック**: フォーム回答の妥当性チェック
4. **進捗管理**: 転記状況・対応状況の一元管理
