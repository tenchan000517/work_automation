/**
 * 必要なマニュアル・フォーマット一覧をスプレッドシートに作成するGAS
 *
 * 使用方法:
 * 1. Googleスプレッドシートを開く
 * 2. 拡張機能 > Apps Script
 * 3. このコードを貼り付けて保存
 * 4. createManualList() を実行
 */

function createManualList() {
  const ss = SpreadsheetApp.getActiveSpreadsheet();

  // 既存のシートがあれば削除
  const existingSheet = ss.getSheetByName('必要なマニュアル一覧');
  if (existingSheet) {
    ss.deleteSheet(existingSheet);
  }

  // 新しいシートを作成
  const sheet = ss.insertSheet('必要なマニュアル一覧');

  // ========================================
  // 1. マニュアル一覧
  // ========================================
  const manualData = [
    ['【マニュアル一覧】', '', '', '', '', ''],
    ['No', '種別', 'マニュアル名', '対象商材', '対象業務', '優先度'],
    ['M01', '共通', 'ヒアリングシート使用マニュアル', 'ツナゲル, バツグン, HP, LP, SNS, PV, パンフ, ロゴ', '構成設計・ヒアリング', '高'],
    ['M02', '共通', '初回打ち合わせマニュアル', 'ツナゲル, HP, PV', '構成設計', '高'],
    ['M03', '共通', '撮影マニュアル（撮り方・データ確認・チェック）', 'ツナゲル, HP, PV', '撮影', '高'],
    ['M04', '共通', 'データ共有マニュアル（ドライブ使い方＋テンプレ）', 'ツナゲル, HP, PV', '撮影・データ納品', '高'],
    ['M05', '共通', 'FBマニュアル（月次フィードバック進行）', 'ツナゲル, バツグン, HP, LP, SNS', '月次FB', '中'],
    ['M06', '共通', '納品・最終打ち合わせマニュアル', 'HP, PV', 'キックオフ・最終打合せ', '中'],
    ['M07', '共通', 'メール送信マニュアル（確認依頼等）', 'ツナゲル, HP, PV', '確認依頼', '中'],
    ['M08', 'ツナゲル', 'NOTTA使用マニュアル', 'ツナゲル', 'ヒアリング内容整理', '中'],
    ['M09', 'ツナゲル', 'フォルダ格納マニュアル（フォルダ名＋作り方）', 'ツナゲル', 'ヒアリング内容整理', '中'],
    ['M10', 'ツナゲル', '現地打合せマニュアル', 'ツナゲル', '企画・質問設計', '中'],
    ['M11', 'ツナゲル', '動画編集マニュアル', 'ツナゲル', '編集', '中'],
    ['M12', 'ツナゲル', '週間データ集計マニュアル', 'ツナゲル', 'FB資料作成', '中'],
    ['M13', 'ツナゲル', 'キックオフMTGマニュアル', 'ツナゲル', 'キックオフMTG', '低'],
    ['M14', 'ツナゲル', '応募対応マニュアル', 'ツナゲル', '応募対応連絡', '低'],
    ['M15', 'HP制作', 'Canvaフォルダ制作マニュアル', 'HP制作', 'デザイン作成', '中'],
    ['M16', 'HP制作', 'HP制作マニュアル', 'HP制作', 'デザイン作成', '中'],
    ['M17', 'HP制作', 'HP運用マニュアル', 'HP制作', 'HPの内容更新', '低'],
    ['M18', '月刊Sing', '取材マニュアル', '月刊Sing', 'インタビュー実施', '中'],
    ['M19', '月刊Sing', 'AI文章構成マニュアル', '月刊Sing', '記事執筆', '中'],
  ];

  // ========================================
  // 2. フォーマット・テンプレート一覧
  // ========================================
  const formatData = [
    ['', '', '', '', '', ''],
    ['【フォーマット・テンプレート一覧】', '', '', '', '', ''],
    ['No', '種別', 'テンプレート名', '対象商材', '対象業務', '優先度'],
    ['F01', '共通', 'ヒアリングシート', 'ツナゲル, バツグン, HP, LP, SNS, PV, パンフ, ロゴ', '構成設計', '高'],
    ['F02', '共通', '打ち合わせ内容共有フォーマット', 'ツナゲル, HP, PV', '初回打合せ後', '高'],
    ['F03', '共通', 'FB資料テンプレート', 'ツナゲル, バツグン, HP, SNS', '月次FB', '高'],
    ['F04', '共通', '議事録テンプレート', 'HP, PV', 'キックオフ・FB', '中'],
    ['F05', '共通', 'メールテンプレート（確認依頼）', 'ツナゲル, HP, PV', '確認依頼', '中'],
    ['F06', 'ツナゲル', '週間集計データ共有テンプレ', 'ツナゲル', 'FB資料作成', '中'],
    ['F07', 'ツナゲル', 'FB報告テンプレート', 'ツナゲル', '月次FB', '中'],
    ['F08', 'ツナゲル', '企業カンペテンプレート', 'ツナゲル', '企画・質問設計', '低'],
    ['F09', 'HP制作', 'HP制作テンプレート', 'HP制作', 'デザイン作成', '中'],
    ['F10', 'PV制作', 'PV基本構成テンプレート', 'PV制作', '参考PV選定', '中'],
    ['F11', 'PV制作', '編集テンプレート', 'PV制作', '編集・BGM', '中'],
    ['F12', 'パンフ', 'パンフデザインテンプレート', 'パンフ', '誌面デザイン', '中'],
    ['F13', 'ロゴ', 'ロゴパターンオーダーシート', 'ロゴ', 'ヒアリング整理', '中'],
  ];

  // ========================================
  // 3. チェックリスト一覧
  // ========================================
  const checklistData = [
    ['', '', '', '', '', ''],
    ['【チェックリスト一覧】', '', '', '', '', ''],
    ['No', '種別', 'チェックリスト名', '対象商材', '対象業務', '優先度'],
    ['C01', 'HP制作', 'HP制作チェックリスト', 'HP制作', 'デザイン作成', '中'],
    ['C02', 'PV制作', 'PV編集チェックリスト', 'PV制作', '編集・BGM', '中'],
    ['C03', 'パンフ', 'パンフ校正チェックシート', 'パンフ', '誤字脱字チェック', '中'],
    ['C04', '共通', 'データ格納チェックリスト', 'HP, PV', 'データ共有', '低'],
  ];

  // ========================================
  // 4. 商材別必要物サマリー
  // ========================================
  const summaryData = [
    ['', '', '', '', '', ''],
    ['【商材別 必要物サマリー】', '', '', '', '', ''],
    ['商材', 'マニュアル数', 'テンプレート数', 'チェックリスト数', '合計', '備考'],
    ['ツナゲル', '7', '3', '0', '10', '詳細情報は充実済み'],
    ['バツグン', '1', '1', '0', '2', 'ヒアリングシート・FB資料'],
    ['HP制作', '5', '2', '1', '8', '共通マニュアル含む'],
    ['LP制作', '1', '0', '0', '1', 'ヒアリングシートのみ'],
    ['SNS広告', '1', '2', '0', '3', 'ヒアリングシート・FB資料'],
    ['PV制作', '3', '2', '1', '6', '共通マニュアル含む'],
    ['パンフ', '1', '2', '1', '4', 'テンプレート中心'],
    ['ロゴ', '1', '1', '0', '2', 'ヒアリングシート中心'],
    ['月刊Sing', '2', '0', '0', '2', '取材・AI文章'],
  ];

  // ========================================
  // 5. 優先度別作成順序
  // ========================================
  const priorityData = [
    ['', '', '', '', '', ''],
    ['【優先度別 作成順序】', '', '', '', '', ''],
    ['順位', '優先度', '項目名', '種別', '理由', ''],
    ['1', '高', 'ヒアリングシート', 'テンプレート', '8商材で共通使用', ''],
    ['2', '高', '打ち合わせ内容共有フォーマット', 'テンプレート', '3商材で共通使用', ''],
    ['3', '高', '初回打ち合わせマニュアル', 'マニュアル', '3商材で共通使用', ''],
    ['4', '高', '撮影マニュアル', 'マニュアル', '3商材で共通化可能', ''],
    ['5', '高', 'データ共有マニュアル', 'マニュアル', '全商材で共通化可能', ''],
    ['6', '高', 'FB資料テンプレート', 'テンプレート', '5商材で共通使用', ''],
    ['7', '中', 'FBマニュアル', 'マニュアル', '5商材で共通使用', ''],
    ['8', '中', '週間データ集計マニュアル', 'マニュアル', 'ツナゲル固有', ''],
    ['9', '中', '動画編集マニュアル', 'マニュアル', 'ツナゲル・PV', ''],
    ['10', '中', 'HP制作マニュアル・テンプレート', 'マニュアル', 'HP固有', ''],
    ['11', '中', 'メールテンプレート', 'テンプレート', '3商材で共通', ''],
    ['12', '中', '各種チェックリスト', 'チェックリスト', '品質担保', ''],
  ];

  // ========================================
  // データを書き込み
  // ========================================
  let currentRow = 1;

  // マニュアル一覧
  sheet.getRange(currentRow, 1, manualData.length, 6).setValues(manualData);
  currentRow += manualData.length;

  // フォーマット一覧
  sheet.getRange(currentRow, 1, formatData.length, 6).setValues(formatData);
  currentRow += formatData.length;

  // チェックリスト一覧
  sheet.getRange(currentRow, 1, checklistData.length, 6).setValues(checklistData);
  currentRow += checklistData.length;

  // サマリー
  sheet.getRange(currentRow, 1, summaryData.length, 6).setValues(summaryData);
  currentRow += summaryData.length;

  // 優先度別
  sheet.getRange(currentRow, 1, priorityData.length, 6).setValues(priorityData);

  // ========================================
  // 書式設定
  // ========================================

  // 列幅の設定
  sheet.setColumnWidth(1, 60);   // No
  sheet.setColumnWidth(2, 80);   // 種別
  sheet.setColumnWidth(3, 300);  // 名前
  sheet.setColumnWidth(4, 300);  // 対象商材
  sheet.setColumnWidth(5, 150);  // 対象業務
  sheet.setColumnWidth(6, 80);   // 優先度

  // ヘッダー行の書式設定
  const headerRows = [1, 2, 23, 24, 41, 42, 50, 51, 62, 63];
  headerRows.forEach(row => {
    const range = sheet.getRange(row, 1, 1, 6);
    if (row === 1 || row === 23 || row === 41 || row === 50 || row === 62) {
      // セクションタイトル
      range.setBackground('#1a73e8');
      range.setFontColor('#ffffff');
      range.setFontWeight('bold');
      range.setFontSize(12);
    } else {
      // カラムヘッダー
      range.setBackground('#e8f0fe');
      range.setFontWeight('bold');
    }
  });

  // 優先度による色分け
  const dataRange = sheet.getDataRange();
  const values = dataRange.getValues();

  for (let i = 0; i < values.length; i++) {
    const priority = values[i][5];
    if (priority === '高') {
      sheet.getRange(i + 1, 6).setBackground('#fce8e6').setFontColor('#c5221f');
    } else if (priority === '中') {
      sheet.getRange(i + 1, 6).setBackground('#fef7e0').setFontColor('#e37400');
    } else if (priority === '低') {
      sheet.getRange(i + 1, 6).setBackground('#e6f4ea').setFontColor('#137333');
    }
  }

  // 罫線を追加
  dataRange.setBorder(true, true, true, true, true, true);

  // フィルターを設定（マニュアル一覧のヘッダー行）
  sheet.getRange(2, 1, 1, 6).createFilter();

  // 完了メッセージ
  SpreadsheetApp.getUi().alert('「必要なマニュアル一覧」シートを作成しました！');
}
