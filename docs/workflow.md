# 求人原稿作成ワークフロー

## 全体フロー図

```
┌─────────────────────────────────────────────────────────────┐
│                        準備フェーズ                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐     │
│  │ テンプレート  │───▶│ 企業別シート │───▶│ 企業に送付   │     │
│  │ からコピー    │    │ 作成        │    │ （黄色入力）  │     │
│  └─────────────┘    └─────────────┘    └─────────────┘     │
│         │                                                   │
│         ▼                                                   │
│  GAS: 📋ヒアリングシート > 新規作成                           │
│                                                             │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                     ヒアリングフェーズ                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐     │
│  │ 企業から     │───▶│ 打ち合わせ   │───▶│ インタビュー  │     │
│  │ 回答受領    │    │ 実施        │    │ 実施        │     │
│  └─────────────┘    └─────────────┘    └─────────────┘     │
│                           │                   │             │
│                           ▼                   ▼             │
│                    青色セル入力         録音・文字起こし      │
│                                        （LINEWORKS）        │
│                                                             │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                      原稿作成フェーズ                         │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐     │
│  │ GASで       │───▶│ プロンプトに │───▶│ AI（Claude） │     │
│  │ JSON出力    │    │ 素材入力    │    │ で原稿生成   │     │
│  └─────────────┘    └─────────────┘    └─────────────┘     │
│         │                   │                   │           │
│         ▼                   ▼                   ▼           │
│  📄AI出力 > JSON     ・ヒアリングJSON      ・求人原稿       │
│                      ・社長インタビュー    ・キャッチコピー5つ│
│                      ・社員インタビュー                      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                      仕上げフェーズ                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐     │
│  │ 原稿チェック │───▶│ サムネイル   │───▶│ 求人サイト   │     │
│  │ ・修正      │    │ 作成        │    │ 掲載        │     │
│  └─────────────┘    └─────────────┘    └─────────────┘     │
│                           │                                 │
│                           ▼                                 │
│                    キャッチコピーを                          │
│                    画像に重ねる                              │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

## 各ステップ詳細

### 1. テンプレートから企業別シート作成

**操作：**
1. テンプレートスプレッドシートを開く
2. メニュー「📋 ヒアリングシート」>「🆕 新規作成」
3. 企業名を入力
4. 新しいスプレッドシートが自動生成

**結果：**
- 「【企業名】原稿ヒアリングシート」が作成される
- 企業名が自動入力される

### 2. 企業への送付・回答受領

**送付内容：**
- 作成したスプレッドシートのURLを共有
- 黄色セルの入力を依頼

**確認ポイント：**
- 必須項目が埋まっているか
- 住所・連絡先は正確か
- 給与情報にみなし残業が含まれるか確認

### 3. 打ち合わせ・インタビュー

**打ち合わせで確認：**
- 青色セル（内部記入欄）の情報
- 会社の魅力・雰囲気
- 募集背景の詳細

**インタビュー対象：**
- 社長（会社のビジョン・想い）
- 社員1名（実際の働き方・やりがい）

**録音・文字起こし：**
- LINEWORKSで録音
- 文字起こし機能でテキスト化

### 4. GASでJSON出力

**操作：**
1. 記入済みスプレッドシートを開く
2. メニュー「📄 AI出力」>「JSONでダウンロード」
3. ダイアログから「コピー」または「ダウンロード」

**フォーマット自動判定：**
- 旧フォーマット（列0にセクション名）
- 新フォーマット（▼マークでセクション開始）

### 5. AIプロンプトに入力

**入力素材：**
1. ヒアリングシートJSON
2. 社長インタビュー文字起こし
3. 社員インタビュー文字起こし

**使用プロンプト：**
`prompts/job-posting-prompt.md`

### 6. 出力確認・修正

**確認ポイント：**
- 事実と異なる記載がないか
- 誇張表現がないか
- 企業のトーンに合っているか

### 7. サムネイル作成

**キャッチコピー活用：**
- 5つのキャッチコピーを5枚のスライド画像に
- 写真 + テキストオーバーレイ

---

## ファイル一覧

| ファイル | 用途 |
|---------|------|
| `gas/integrated-menu.js` | 統合メニュー（onOpen関数） |
| `gas/template-manager.js` | テンプレート管理機能 |
| `gas/old-format-export.js` | 旧フォーマット出力 |
| `gas/new-format-export.js` | 新フォーマット出力 |
| `prompts/job-posting-prompt.md` | AI用プロンプト |

---

## トラブルシューティング

### JSON出力が空になる
- シート構造を確認：「🔧 シート構造を確認」で列配置をチェック
- Part①/Part②の記載があるか確認

### 旧/新フォーマットの判定が間違う
- 「フォーマット指定」サブメニューから手動選択

### 文字化けする
- UTF-8でファイルを開く
- JSONは直接コピー推奨
